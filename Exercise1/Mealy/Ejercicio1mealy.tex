%\input{./preamble.tex}

%\begin{document}

%\input{caratula.tex}
%
%\pagenumbering{roman}
%\tableofcontents
%\newpage
%\pagenumbering{arabic}
%
%Test Text

%%%%%EJ1.MEALY


\subsection{\color{purple}Mealy State Machine}

In the Mealy state machine, the output value not only depends on the state we are but also depends on the input values. This is to say the output could be represented as a function like $Z=f(X_1.....X_n,Q_1....Q_n)$ where Z: output, Q: State and X:Input event as could be visualize:

 \begin{figure}[H]
        \centering
        \includegraphics[scale=0.75]{../Exercise1/Mealy/mealydiagram.png}
        \caption{\color{cyan}Mealy sate machine simple representation}
        \label{fig:ej1mealyr}
    \end{figure}

In this exercise, two sensors I and S function as input event to the state machine. Analyzing the possible states and event we obtain the following Mealy machine diagram:

 \begin{figure}[H]
        \centering
        \includegraphics[scale=0.65]{../Exercise1/Mealy/ej1mealy.png}
        \caption{\color{cyan}Exercise 1: Mealy sate machine flow chart}
        \label{fig:ej1mealyd}
    \end{figure}

Which is represented as follow:

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
\hline
\multicolumn{3}{|c|}{\multirow{2}{*}{\textbf{State(Q)}}} & \multicolumn{8}{c|}{\textbf{Input(X)}} \\ \cline{4-11} 
\multicolumn{3}{|c|}{} & \multicolumn{2}{c|}{\textbf{I=0 S=0}} & \multicolumn{2}{c|}{\textbf{I=0 S=1}} & \multicolumn{2}{c|}{\textbf{I=1 S=0}} & \multicolumn{2}{c|}{\textbf{I=1 S=1}} \\ \hline
\textbf{Representation} & \textbf{Q2} & \textbf{Q1} & \textbf{Q2} & \textbf{Q1} & \textbf{Q2} & \textbf{Q1} & \textbf{Q2} & \textbf{Q1} & \textbf{Q2} & \textbf{Q1} \\ \hline
\textbf{Empty} & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 1 \\ \hline
\textbf{Error} & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 1 \\ \hline
\textbf{Half} & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 1 \\ \hline
\textbf{Full} & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 1 \\ \hline
\textbf{Output(Z)} & \textbf{Z1} & \textbf{Z2} & \textbf{0} & \textbf{0} & \textbf{1} & \textbf{1} & \textbf{1} & \textbf{0} & \textbf{1} & \textbf{1} \\ \hline
\end{tabular}
\caption{\color{cyan}Exercise 1: Mealy sate machine}
\end{table}

\pagebreak
So the logic circuit would be:

 \begin{figure}[H]
        \centering
        \includegraphics[scale=1]{../Exercise1/Mealy/ej1mealycircuit.png}
        \caption{\color{cyan}Exercise 1: Mealy logic circuit}
        \label{fig:ej1mealyld}
    \end{figure}

We can notice that the input event and the output event are the same which could make the $Z_N=X_N$ with N: the output or input number, but as mention be in the Mealy state machine the output $Z=f(X_1.....X_n,Q_1....Q_n)$, so we considered essential the use of sate in the circuit is dependent with the state and the input to have a clear view of being a Mealy state machine.

\subsubsection{\color{Orange}Simulation}

For the simulation of this stage machine, as the pump B1 and B2 alternate their function when $I = 1 y S = 0$ and for the activation of the pump that depends on output voltage is needed the following circuit is added:

 \begin{figure}[H]
        \centering
        \includegraphics[scale=1]{../Exercise1/Mealy/ej1mealycircuitplus.png}
        \caption{\color{cyan}Exercise 1: Mealy additional logic circuit for the simulation}
        \label{fig:ej1mealylp}
    \end{figure}
    
Simulation the complete circuit in Verilog and testing the possibles values of input in Gtkwave the result was:

 \begin{figure}[H]
        \centering
        \includegraphics[scale=0.7]{../Exercise1/Mealy/ej1mealysim1.png}\\
        \vspace{0.2cm}
        \includegraphics[scale=0.73]{../Exercise1/Mealy/ej1mealysim2.png}
        \caption{\color{cyan}Exercise 1: Simulation results}
        \label{fig:ej1mealyw}
    \end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%\end{document}